---
title: Javascript test tools
category: js
keywords: javascript, testing, jest, mocha, karma, jasmine
---

### Test runners
- Mocha (assertions, reporterы, будучи загруженным в браузер может прогонять в нем тесты)
- Karma (сервер, который запускает тесты в разных браузерах)
- Jest (watch-режим, подключает jsdom для эмуляции апи браузера )
- puppeteer (headless chromium api, который позволяет открывать страницы, свободно манипулировать разметкой, запускать скрипты, снимать скриншоты, перехватывать запросы и отдавать фейковые ответы)
- selenium (драйвер, позволяющий единообразно управлять разными браузерами )

### Assertion libraries
- Chai (and chai-as-promised for Promises)
- Expect
- Jasmine
- Jest (uses Jasmine)

### Mock library
- Sinon
- Jest

[Другие соверменные инструменты для тестирования веб-проектов](https://habr.com/company/ruvds/blog/349452/)

### Combinations
- Mocha, Chai/Expect, Sinon + [mocha-webpack](https://github.com/zinserjan/mocha-webpack) ([пример](https://vue-test-utils.vuejs.org/ru/guides/testing-single-file-components-with-mocha-webpack.html))
- Jest itself
- Karma, Mocha
<https://www.robinwieruch.de/react-testing-tutorial/#react-e2e-tests-cypress>

[Пример кофигурации Karma и Mocha с Enzyme для тестирования React-компонентов (середина 2017 г)](https://github.com/Jukejc/react-redux-starter)


Snapshot тесты проще. Они могут проверить рендеринг компонента в ответ на изменяющиеся свойства и изменения стейта в ответ на простые действия типа клика и чейнджа. Иногда можно менять стейт напрямую ради того, чтобы посмотреть на импорт (логику хендлеров так не проверить).
Вообще тестировать компоненты надо раздельно: рендеринг и коллбеки. Для рендеринга хватит снепшотов и прямого манипулирования свойствами и стейтом. Для коллбеков в зависимости от используемого api, можно обойтись и shallow оберткой с simulate, и jsdom. Однако надо не забывать про [проблему с асинхронным ререндерингом](https://github.com/airbnb/enzyme/issues/728) в ответ на изменение стейта или property. В этом случае можно либо подождать по таймеру, либо все же использовать юнит-тестирование в реальном браузере (selenium, puppeteer или karma).

Хендлеры, не работающие со стейтом компонента, можно вынести во внешний, оберточный компонент, который рендерит всегда одно и то же, и из shallow-инстанса внутреннего компонента руками вызывать методы.

Компонент, который полностью стейтлесс и рендерит разметку, получая параметры из свойств - плохой кандидат для снепшот тестирования, поскольку вероятность ненамеренного изменения там минимальна. В то же время такое тестирование простое само по себе. При разработке можно быстро получать разметку, вызывая debug у wrapper-а.
Но лишь компонент с логикой генерации свойств, результат которого отображается на разметку, получит преимущества от снепшот-тестирования, поскольку даст возможность заметить поломку логики через изменившуюся разметку (как аутпут компонента).

Опять же, в таком случае тестировать клик-чейндж хендлеры можно и в shallow-режиме, начинку callback-методов - с JSDOM или в Karma

Если компонент активно использует конкретные импорты, манипулирует DOM-ом, документом, содержит много логики в коллбеках и  использует методы браузера, то (в зависимости от конкретной ситуации), придется применять JSDOM или, в крайнем случае, Karma.

e2e-тест можно устроить при помощи puppeteer в сочетании с любым тест-раннером, прямо в тесте монтируя элемент на заготовленную страницу [(хороший пример реализации)](https://stackoverflow.com/a/48035638/2169953)
<div markdown="1" class="block green">
Если охота не e2e тест, а юнит в реальном браузере со всеми примочками в виде быстрого запуска, репорта, coverage и watch, то можно соединить запускатель karma с тестами на mocha+chai+enzyme, собираемые webpack-ком.
* Настройка кармы с вебпаком [тут](https://github.com/webpack-contrib/karma-webpack)
* [Репозиторий с примером связки](https://github.com/Jukejc/react-redux-starter)
* [Подробное объяснение конфига кармы для связки](https://medium.com/@Jukejc/setting-up-karma-to-work-with-enzyme-mocha-and-webpack-in-2017-1ab0c2e9ef00)
</div>
